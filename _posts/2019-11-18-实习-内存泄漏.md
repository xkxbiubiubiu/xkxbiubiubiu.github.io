---
layout:     post
title:    实习-内存泄漏
subtitle:  
date:       2019-11-18
author:     
header-img: 
catalog: true
tags:
    - < 笔记整理 >
typora-root-url: ..

---



原文链接：http://www.cnblogs.com/Man-Dream-Necessary/p/9772714.html 

#### **什么是内存泄露？**

已经不再使用的内存未能被程序释放，叫内存泄露(memory leak)。

#### **内存泄露会带来什么样的后果？**

内存泄露会因为减少可用内存数量从而降低计算机性能，严重的可能导致设备停止正常工作，或者应用程序崩溃。

#### **什么情况下出现内存泄漏？** 

当一块内存不再用到，但是垃圾回收机制又无法释放这块内存的时候，就导致内存泄漏。

#### **出现内存泄露的的几种常见情况：** 

##### 1.全局变量

```
由于JavaScript对未声明变量的处理方式是在全局对象上创建该变量的引用。如果在浏览器中，全局对象就是window对象。
变量在窗口关闭或重新刷新页面之前都不会被释放，如果未声明的变量缓存大量的数据，就会导致内存泄露。
```

```
通过this也会创建全局变量，当在全局作用域中调用一个函数，这个函数内部用this.var的方式创建了一个变量，此时  this指向的是全局对象(window)，而不是'undefined'
```

##### 2.闭包

```
闭包可以读取函数内部的变量，然后让这些变量始终保存在内存中。如果在使用结束后没有将局部变量清除，就可能导致内存泄露。
```

##### 3.事件监听

```
对同一个事件重复监听，但是忘记移除，会导致内存泄露。
```

##### 4.其他

```
console.log打印的对象不能被垃圾回收，可能会导致内存泄露。
setInterval也可能会导致内存泄露。
```

####  **前端如何检查内存泄露？** 

(1).使用Chrome的开发者工具profiles来进行快照对比。

(2).如果是在Node环境下，可以用Node提供的process.memoryUsage()方法来检查内存泄露:

​	**rss** (resident set size) : 所有内存占用，包括指令区和堆栈。

​	**heapTotal** : "堆"占用的内存，包括用到的和未用到的。

​	**heapUsed** : 用到的堆。

​	**external** : V8引擎内部C++对象占用的内存。

​	判断内存泄露以**heapUsed为准。**

